{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Kesapalana{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <!-- AOS Animation Library -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" />
    <style>
        body { background: #101917; color: #fff; font-family: 'Inter', Arial, sans-serif; margin: 0; }
        header, footer { background: #101917; }
        nav { display: flex; gap: 2rem; align-items: center; }
        nav a { color: #fff; text-decoration: none; font-weight: 500; }
        .btn-orange { background: #f6a32b; color: #101917; border: none; padding: 0.7em 1.5em; border-radius: 3px; font-weight: bold; cursor: pointer; }
        .footer { background: #101917; color: #fff; padding: 2em 0; border-top: 1px solid #222; }
        .footer .col { margin-bottom: 1em; }
        .footer h4 { color: #f6a32b; margin-bottom: 0.5em; }
        .footer input[type='email'] { padding: 0.5em; border-radius: 2px; border: none; }
        .footer button { margin-left: 0.5em; }
        main { min-height: 70vh; }
    </style>
    {% block extra_head %}{% endblock %}
        <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                if (window.AOS) AOS.init({ duration: 900, once: true, easing: 'ease-in-out' });
            });
        </script>
</head>
<body>
    <header>
        <div style="display:flex;justify-content:space-between;align-items:center;padding:1.5em 3em;">
            <a href="/core/" style="font-size:2em;font-weight:bold;letter-spacing:2px;color:#fff;text-decoration:none;">KESĀPALANA</a>
            <nav>
                <a href="/products/">Shop All</a>
                <a href="/core/science/">Our Science</a>
                {% if user.is_authenticated %}
                    <a href="{% url 'cart:cart_detail' user.username %}">Cart</a>
                    <a href="/orders/">Orders</a>
                    <a href="/core/contact/">Contact</a>
                    <div class="profile-dropdown-container">
                        <button class="profile-btn" id="profileDropdownBtn">
                            <img src="https://ui-avatars.com/api/?name={{ user.first_name|default:user.username }}&background=f6a32b&color=101917&rounded=true&size=32" alt="Avatar" class="profile-avatar">
                            <span>Profile</span>
                            <svg style="margin-left:0.3em;vertical-align:middle;" width="14" height="14" viewBox="0 0 20 20"><path fill="#fff" d="M5.293 7.293a1 1 0 0 1 1.414 0L10 10.586l3.293-3.293a1 1 0 1 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4a1 1 0 0 1 0-1.414z"/></svg>
                        </button>
                        <div class="profile-dropdown" id="profileDropdownMenu">
                            <a href="/users/profile/">My Profile</a>
                            <a href="/users/address-book/">Address Book</a>
                            <a href="/users/orders/">Order History</a>
                            <form method="post" action="/users/logout/" style="margin:0;">
                                {% csrf_token %}
                                <button type="submit">Logout</button>
                            </form>
                        </div>
                    </div>
                    <style>
                        .profile-dropdown-container {
                            position: relative;
                            display: inline-block;
                            margin-left: 2em;
                        }
                        .profile-btn {
                            background: none;
                            border: none;
                            color: #fff;
                            font-weight: 500;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            gap: 0.5em;
                            font-size: 1.08em;
                            padding: 0.2em 0.7em 0.2em 0.2em;
                            border-radius: 6px;
                            transition: background 0.2s;
                        }
                        .profile-btn:hover, .profile-btn.active {
                            background: #222;
                        }
                        .profile-avatar {
                            width: 32px;
                            height: 32px;
                            border-radius: 50%;
                            margin-right: 0.3em;
                            border: 2px solid #f6a32b;
                            background: #fff;
                        }
                        .profile-dropdown {
                            display: none;
                            position: absolute;
                            right: 0;
                            top: 110%;
                            min-width: 180px;
                            background: #181f1b;
                            border-radius: 8px;
                            box-shadow: 0 8px 32px #0005;
                            z-index: 100;
                            padding: 0.7em 0.5em 0.7em 0.5em;
                            opacity: 0;
                            transform: translateY(-10px) scale(0.98);
                            pointer-events: none;
                            transition: opacity 0.25s cubic-bezier(.4,0,.2,1), transform 0.25s cubic-bezier(.4,0,.2,1);
                        }
                        .profile-dropdown.show {
                            display: block;
                            opacity: 1;
                            transform: translateY(0) scale(1);
                            pointer-events: auto;
                        }
                        .profile-dropdown a, .profile-dropdown button[type="submit"] {
                            display: block;
                            color: #fff;
                            text-decoration: none;
                            padding: 0.7em 1.2em;
                            border-radius: 5px;
                            font-size: 1.05em;
                            background: none;
                            border: none;
                            text-align: left;
                            width: 100%;
                            cursor: pointer;
                            transition: background 0.18s;
                        }
                        .profile-dropdown a:hover, .profile-dropdown button[type="submit"]:hover {
                            background: #222;
                            color: #f6a32b;
                        }
                        .profile-dropdown form {
                            margin: 0;
                        }
                    </style>
                    <script>
                        // Profile dropdown animation and outside click
                        const profileBtn = document.getElementById('profileDropdownBtn');
                        const profileMenu = document.getElementById('profileDropdownMenu');
                        if (profileBtn && profileMenu) {
                            profileBtn.addEventListener('click', function(e) {
                                e.stopPropagation();
                                profileMenu.classList.toggle('show');
                                profileBtn.classList.toggle('active');
                            });
                            document.addEventListener('click', function(e) {
                                if (!profileMenu.contains(e.target) && !profileBtn.contains(e.target)) {
                                    profileMenu.classList.remove('show');
                                    profileBtn.classList.remove('active');
                                }
                            });
                        }
                    </script>
                {% else %}
                    <a href="/users/login/">Login</a>
                    <a href="/users/register/">Register</a>
                    <a href="/users/login/">Cart</a>
                    <a href="/orders/">Orders</a>
                    <a href="/core/contact/">Contact</a>
                    <a href="/users/register/" class="btn-orange" style="text-decoration:none;">START JOURNEY</a>
                {% endif %}
            </nav>
        </div>
    </header>
    <main>
        {% block content %}{% endblock %}
    </main>
    <footer class="footer">
        <div style="display:flex;justify-content:space-around;flex-wrap:wrap;">
            <div class="col">
                <h4>KESĀPALANA</h4>
                <p>Result-effective hair care solutions engineered exclusively for men. Blending tradition with science for superior growth and strength.</p>
            </div>
            <div class="col">
                <h4>PRODUCTS</h4>
                <p style="margin:0;">
                    <a href="/products/?category=hair-oil" style="color:#fff;text-decoration:none;">Hair Oil</a><br>
                    <a href="/products/?category=growth-serum" style="color:#fff;text-decoration:none;">Growth Serum</a><br>
                    <a href="/products/?category=minoxidil" style="color:#fff;text-decoration:none;">Minoxidil</a><br>
                    <a href="/products/?category=vitamins" style="color:#fff;text-decoration:none;">Vitamins</a>
                </p>
            </div>
            <div class="col">
                <h4>COMPANY</h4>
                <p style="margin:0;">
                    <a href="/core/science/" style="color:#fff;text-decoration:none;">Our Science</a><br>
                    <a href="/core/ingredients/" style="color:#fff;text-decoration:none;">Ingredients</a><br>
                    <a href="/core/success-stories/" style="color:#fff;text-decoration:none;">Success Stories</a>
                </p>
            </div>
            <div class="col">
                <h4>STAY UPDATED</h4>
                <form>
                    <input type="email" placeholder="EMAIL ADDRESS">
                    <button class="btn-orange">JOIN</button>
                </form>
            </div>
        </div>
        <div style="text-align:center;margin-top:2em;font-size:0.9em;">
            &copy; 2026 Kesapalana. All rights reserved. Men's Hair Care Specialists.
        </div>
    </footer>
</body>
</html>