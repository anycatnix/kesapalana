{% extends 'base.html' %}
{% load static %}
{% block content %}
<div style="max-width: 1200px; margin: 3em auto 4em auto; background: #181f1b; border-radius: 14px; box-shadow: 0 4px 24px #0003; padding: 2.5em 2em;">
    <h2 style="color: #f6a32b; text-align: center; font-size: 2.2em; margin-bottom: 1.5em; letter-spacing: 1px;">All Products</h2>
    <form method="get" action="" style="display:flex;gap:1em;justify-content:center;margin-bottom:2em;">
        <input type="text" name="q" value="{{ search_query }}" placeholder="Search products..." style="flex:1;max-width:320px;padding:0.8em 1em;border-radius:4px;border:1px solid #333;background:#101917;color:#fff;">
        <button type="submit" class="btn-orange" style="padding:0.8em 2em;font-size:1em;">Search</button>
    </form>
    <div style="display:flex;gap:1em;justify-content:center;margin-bottom:2.5em;flex-wrap:wrap;">
        <a href="?" style="color:#fff;background:#222;padding:0.6em 1.3em;border-radius:20px;text-decoration:none;font-size:1em;{% if not request.GET.category %}border:2px solid #f6a32b;{% endif %}">All Categories</a>
        {% for category in categories %}
            <a href="?category={{ category.slug }}" style="color:#fff;background:#222;padding:0.6em 1.3em;border-radius:20px;text-decoration:none;font-size:1em;{% if request.GET.category == category.slug %}border:2px solid #f6a32b;{% endif %}">{{ category.name }}</a>
        {% endfor %}
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:2em;">
        {% for product in products %}
            <div style="background:#101917;border-radius:10px;box-shadow:0 2px 12px #0002;padding:1.5em;display:flex;flex-direction:column;align-items:center;justify-content:space-between;">
                <a href="{% url 'products:product_detail' product.slug %}" style="text-decoration:none;color:inherit;width:100%;">
                    {% if product.images.all|length > 0 %}
                        <img src="{{ product.images.all.0.image.url }}" alt="{{ product.name }}" style="width:100%;max-width:180px;height:180px;object-fit:cover;border-radius:8px;box-shadow:0 2px 12px #0002;margin-bottom:1em;" />
                    {% else %}
                        <img src="{% static 'img/default_product.png' %}" alt="No image" style="width:100%;max-width:180px;height:180px;object-fit:cover;border-radius:8px;box-shadow:0 2px 12px #0002;margin-bottom:1em;" />
                    {% endif %}
                    <div style="font-size:1.1em;color:#fff;font-weight:bold;text-align:center;">{{ product.name }}</div>
                </a>
                <div style="color:#ccc;font-size:0.98em;margin:0.5em 0 1em 0;text-align:center;">{{ product.short_description|default:product.description|truncatechars:80 }}</div>
                <div style="display:flex;justify-content:space-between;align-items:center;width:100%;margin-top:auto;">
                    <span style="color:#f6a32b;font-weight:bold;font-size:1.1em;">â‚¹{{ product.price }}</span>
                    {% if product.featured %}<span style="background:#f6a32b;color:#101917;padding:0.2em 0.8em;border-radius:12px;font-size:0.95em;font-weight:600;">Featured</span>{% endif %}
                </div>
            </div>
        {% empty %}
            <div style="grid-column:1/-1;text-align:center;padding:3em 0;">
                <img src="https://cdn-icons-png.flaticon.com/512/4076/4076549.png" alt="No Products" style="width:90px;opacity:0.7;margin-bottom:1.2em;"/>
                <p style="color:#ccc;font-size:1.15em;">No products found.<br>Try a different search or category.</p>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
